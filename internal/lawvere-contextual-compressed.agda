{-# OPTIONS --without-K #-}
module lawvere-contextual-compressed
  {o a} {p r râ‚‚}
  (ğ’ : Set o)
  (_~>_ : ğ’ â†’ ğ’ â†’ Set a)
  (id : âˆ€ {a} â†’ a ~> a)
  (_â¨¾_ : âˆ€ {a b c} â†’ a ~> b â†’ b ~> c â†’ a ~> c)
  (_Ã—_ : ğ’ â†’ ğ’ â†’ ğ’)
  (dup : âˆ€ {a} â†’ (a ~> (a Ã— a)))
  (_Ã—Ã—_ : âˆ€ {a b c d} â†’ (a ~> b) â†’ (c ~> d) â†’ ((a Ã— c) ~> (b Ã— d)))
  (ğŸ™ : ğ’)
--  (â–¡ : ğ’ â†’ ğ’)
  (B : ğ’)
  (inf : ğ’) -- inf := Î” (Î£ (â–¡inf) R â†’ Î£P)
  (P : (ğŸ™ ~> B) â†’ Set p)
  (Î£P : ğ’) -- Î£ (â–¡ B) P
  (f : Î£P ~> B)
  (R : (ğŸ™ ~> inf) â†’ Set r)
  (Î£R : ğ’) -- Î£ (â–¡ inf) R
  (Râ‚‚ : (ğŸ™ ~> Î£R) â†’ Set râ‚‚)
  (Î£Râ‚‚ : ğ’) -- Î£ (â–¡ Î£R) Râ‚‚
  (Ã—Ã—Î£Râ‚‚P-but-this-needs-a-better-name : (l : Î£R ~> B) â†’ (r : âˆ€ i â†’ Râ‚‚ i â†’ P (i â¨¾ l)) â†’ Î£Râ‚‚ ~> Î£P)
  (pair-Î£Râ‚‚ : (l : ğŸ™ ~> Î£R) â†’ Râ‚‚ l â†’ (ğŸ™ ~> Î£Râ‚‚))
  (quot : Î£R ~> Î£Râ‚‚)
  (Ï• : (Î£R Ã— Î£Râ‚‚) ~> Î£P) -- â–¡ (inf Ã— â–¡ inf) ~> â–¡ B)
  (Ï•â»Â¹ : (Î£Râ‚‚ ~> Î£P) â†’ (ğŸ™ ~> Î£R))
  (f : Î£P ~> B)
  where

k : Î£R ~> B
k = ((dup â¨¾ (id Ã—Ã— quot)) â¨¾ Ï•) â¨¾ f

module _ (sâ‚ : âˆ€ (i : ğŸ™ ~> Î£R) â†’ Râ‚‚ i â†’ P (i â¨¾ k)) where
  pt : Î£Râ‚‚ ~> Î£P -- this needs a better name too
  pt = Ã—Ã—Î£Râ‚‚P-but-this-needs-a-better-name k sâ‚

  lawvere : ğŸ™ ~> B
  lawvere = Ï•â»Â¹ pt â¨¾ k


{-
â€˜LÓ§bâ€™ : âˆ€ {X} {S : â–¡ X â†’ Set} {â€˜Sâ€™ : Type (Îµ â–» â€˜â–¡â€™ â€˜â€™ âŒœ X âŒ)} â†’
  let T = â€˜Î£â€™ (â€˜â–¡â€™ â€˜â€™ âŒœ X âŒ) â€˜Sâ€™ in
  (f : â–¡(T â€˜â†’â€™ X))
  (â€˜Sáµ¢â€™ : Type (Îµ â–» â€˜TypeÎµâ€™ â–» â€˜â–¡â€™)) -- âˆ€ {Y} â†’ â–¡(â–¡Y â†’ Type)
  (â€˜quoteÎ£Sáµ¢â€™ : âˆ€ {Y} â†’ â–¡(â€˜Î£â€™ (â€˜â–¡â€™ â€˜â€™ âŒœ Y âŒ) (â€˜Sáµ¢â€™ â€˜â€™â‚ _) â€˜â†’â€™ â€˜â–¡â€™ â€˜â€™ âŒœ â€˜Î£â€™ (â€˜â–¡â€™ â€˜â€™ âŒœ Y âŒ) (â€˜Sáµ¢â€™ â€˜â€™â‚ _) âŒ)) â†’
  let â–¡inf = â€˜Î”â€™ (â€˜Î£â€™ â€˜â–¡â€™ â€˜Sáµ¢â€™ â€˜â†’â€™ Wk T) in
  let â–¡â–¡inf = â€˜â–¡â€™ â€˜â€™ âŒœ â–¡inf âŒ in
  let â–¡â–¡infâ‚› = â€˜Î£â€™ â–¡â–¡inf (â€˜Sáµ¢â€™ â€˜â€™â‚ _) in
  let Ï• = the (â–¡(â–¡inf â€˜Ã—â€™ â–¡â–¡infâ‚› â€˜â†’â€™ T)) (â€˜uncurryâ€™ â€˜â€™â‚ red1nâ†’ (suc (suc zero)) (â€˜Î”-fwdâ€™ {â€˜Î£â€™ â€˜â–¡â€™ â€˜Sáµ¢â€™ â€˜â†’â€™ Wk T})) in
  let p = the (â–¡(â–¡â–¡infâ‚› â€˜â†’â€™ â€˜â–¡â€™ â€˜â€™ âŒœ X âŒ)) (â€˜â€˜â€™â€™â‚ â€˜â€™â‚ âŒœ f â€˜âˆ˜â€™ Ï• âŒâ‚œ â€˜âˆ˜â€™ â€˜â€˜,â€™â€™ â€˜âˆ˜â€™ (â€˜projâ‚â€™ â€˜Ã—Ã—â€™ â€˜quoteÎ£Sáµ¢â€™) â€˜âˆ˜â€™ â€˜dupâ€™) in
  (sâ‚ : â–¡(â€˜Î â€™ â–¡â–¡infâ‚› (Wkâ‚ â€˜Sâ€™ â€˜â€™ (wkâ†’ p â€˜â€™â‚ varâ‚€)))) â†’
  let pt = the (â–¡(â–¡â–¡infâ‚› â€˜â†’â€™ T)) (p â€˜Ã—Ã—Î£'â€™ sâ‚) in
  let Ï•â»Â¹pt = the (â–¡ â–¡â–¡inf) (â€˜â€˜Î”-bakâ€™â€™ â€˜â€™â‚ âŒœ red1nâ† (suc (suc zero)) pt âŒâ‚œ) in
  (sâ‚‚ : â–¡ (â€˜Sáµ¢â€™ â€˜â€™â‚ _ â€˜â€™ Ï•â»Â¹pt)) â†’
  let Ï•â»Â¹pts = the (â–¡ â–¡â–¡infâ‚›) (Ï•â»Â¹pt â€˜,Î£â€™ sâ‚‚) in
  let â€˜lÃ¶bâ€™ = the (â–¡ T) (pt â€˜â€™â‚ Ï•â»Â¹pts) in
  let lÃ¶b = the (â–¡ X) (f â€˜â€™â‚ â€˜lÃ¶bâ€™) in âˆ€
  (sâ‚ƒ : S lÃ¶b)
  â†’ â–¡ X
â€˜LÓ§bâ€™ {X} {S} {â€˜Sâ€™} f â€˜Sáµ¢â€™ â€˜quoteÎ£Sáµ¢â€™ sâ‚ sâ‚‚ sâ‚ƒ = lÃ¶b

-}
{-
lawvere : (ğŸ™ ~> B)
lawvere = p âˆ˜ Ï•â»Â¹ p
  module lawvere where
    p : â–¡ inf ~> B
    p = f âˆ˜ (Ï• âˆ˜ idÃ—quotâˆ˜dup)

lawvere-fix : âˆ€
  (â–¡-map : âˆ€ {a b} â†’ (a ~> b) â†’ (â–¡ a ~> â–¡ b))
  {aâ‚‚} (_â‰ˆ_ : âˆ€ {a b} â†’ (a ~> b) â†’ (a ~> b) â†’ Set aâ‚‚)
  (â–¡tt : ğŸ™ ~> â–¡ ğŸ™)
  (_â– _ : âˆ€ {a b} {f : a ~> b} {g : a ~> b} {h : a ~> b} â†’ f â‰ˆ g â†’ g â‰ˆ h â†’ f â‰ˆ h)
  (assoc : âˆ€ {a b c d} {h : a ~> b} {g : b ~> c} {f : c ~> d} â†’ ((f âˆ˜ g) âˆ˜ h) â‰ˆ (f âˆ˜ (g âˆ˜ h)))
  (2id : âˆ€ {a b} {f : a ~> b} â†’ f â‰ˆ f)
  (_âˆ˜-map_ : âˆ€ {a b c} {f fâ€µ : a ~> b} {g gâ€µ : b ~> c} â†’ g â‰ˆ gâ€µ â†’ f â‰ˆ fâ€µ â†’ (g âˆ˜ f) â‰ˆ (gâ€µ âˆ˜ fâ€µ))
  (Ï•-eq : âˆ€ {f} â†’ ((Ï• âˆ˜ idÃ—quotâˆ˜dup) âˆ˜ Ï•â»Â¹ f) â‰ˆ (â–¡-map (f âˆ˜ Ï•â»Â¹ f) âˆ˜ â–¡tt))
  â†’ lawvere â‰ˆ (f âˆ˜ (â–¡-map lawvere âˆ˜ â–¡tt))
lawvere-fix â–¡-map _â‰ˆ_ â–¡tt _â– _ assoc 2id _âˆ˜-map_ Ï•-eq =
  assoc â–  (2id âˆ˜-map Ï•-eq)
-}
